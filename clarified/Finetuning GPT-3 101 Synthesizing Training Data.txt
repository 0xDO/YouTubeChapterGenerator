In this tutorial, we'll go over how to fine-tune your GPT3 model using synthetic data. Synthetic data is a great way to get exactly the data you want, and it's fast and relatively cheap.

When you're fine-tuning your model, you're not actually training it to do anything new. GPT3 is already trained on many hundreds of gigabytes worth of data. Everything you ask it to do, it already knows how to do. The purpose of fine-tuning is to narrow down to say, "Do this one thing every time."

Because fine-tuning is about removing possibilities, you want to make sure that your fine-tuning data has a broad variety. This way, it has seen many examples. I'll probably do a video going over my question-generating bot because the more variety you show for the input, and the more examples you give in terms of that breadth of variety and different formats, the better it will perform.

Now, when you're doing synthetic data in the way I'm about to show you, it's a very consistent format. But anyway, I wanted to start with something very simple: imagine a complete and detailed plot synopsis for a blank genre, set in a location during a time. Then, the story should be _____ and _____. Write out the entire plot premise in great detail.

Unfortunately, the instruct series models are not the best at going in at long form writing, but you see this one's okay. It's doing all right. It does a pretty good job. It's almost like a movie poster. It's not actually like writing out the story, but this is good enough for now.

With a little bit more prompt engineering, here actually let's try it. Let's instead of premise, let's say outline and see if that modifies it. Yeah, that looks like it's a little bit more detailed, but it's still not actually writing the whole story. Because part of the problem is that GPT3 was not trained on actual plot outlines. And actually, if you watch my other videos, getting GPT3 to actually write fiction is really difficult.

So I'll modify the prompt to say, instead of premise, I'll say plot outline. And we'll just change this here as well. So we're going to say, "Write plot outlines."

Okay, so we've got this. This is the prompt that I'm going to use. And I'm going to auto-populate it with different things. So this is a really quick way to get a broader variety of data. You ask it to do kind of the same prompt but you give it a bunch of different modifiers.

Effectively, what I'm going to do is give it, you know, 200 different prompts and I'm going to record that output and then use that for fine-tuning data. And so the scripts that I've got is here. Here I did something wrong. Okay, the script that I've got is synthesize plots.

So what I've got is I've got a list of genres, a list of modifiers, a list of places, and a list of periods. So you get all this variety. You can get a lot of combinations. The first time I ran it, I had uncommented all these and it was like going to generate 2,000 different samples. I'm not going to spend that much on a tutorial video, so I cut it down to four by four by four by four. So four to the fourth power is 256. So I've got four examples of each of each thing.

And then you might also notice that I've got the up here the uuid. So uuid, let me just show you what it looks like. Oops, synthesize plots. There we go. Okay, so this is this is showing you the the prompts that it's going to run. So it starts with a uuid up at the top. A uuid is just a random string of hexadecimal characters. But one thing that I found is that this does a really good job of of causing GPT3 to have a little bit more internal entropy by starting it with a uuid. It's like, "Okay, I'm reading this. I don't I don't know how to make sense of it." So it's trying to create an internal state that doesn't make any sense. So you you you prime it to be a little bit more different, a little bit more random. This is especially good if you need to run the same prompt over and over and over again. So you do this in combination with a high temperature, and you'll get a lot more variety. But anyway, you can see where it's populated out. "Imagine a complete and detailed plot outline for a science fiction film set in India during the 1990s. The story should be supernatural and otherworldly. Write out the entire plot outline in great detail." And then you see the number here, 256. So if you go back here, you say, "I just did a quick count to keep track of how many it generated just to show you." That's what it's doing. So we can comment this out since we don't need this. And then what we'll do is I have some some canned functions that I use. So here's the uh here's the GPT3 completion. Use text davinci o2 temperature one top p of one token's a thousand. It's not generating anywhere near that much. And then we'll save we'll save all this out to GPT3 logs.

But then what are we going to do with the actual prompt and completion, right? Because for fine-tuning, you need a prompt and a completion. And we're not going to just record these prompts. What would be the point of that? We're not actually adding anything. So what we've got to do is we're going to then format a prompt to look a little bit different. So we'll say completion equals GPT3 completion. And then we'll beat in my prompt. But I've got all the genre, the modifier, the place, and the period. So what I want to do is I'll save the out the out prompt as it'll be a text that uh basically what I'll do is I'll just say um uh let's see genre equals that. And then newline. And then I'll say location is dollar s. And so this dollar s I'll show you what I'm going to do with this.

During the Renaissance in France, two lovers named Pierre and Marie must overcome tremendous obstacles to be together. Their families are rival noble houses, and war is brewing. Undaunted, Pierre and Marie make plans to elope. But they are betrayed by one of Marie's maidservants, and Pierre is mortally wounded in a fierce battle with Marie's jealous older brother, Henry.

When Catherine de Medici is widowed, she flees to Italy and becomes a skilled politician. However, she is not well loved by the people. Marie Lu refuses to leave her husband's side, even when he tells her to flee. This creates a conflict between the two lovers. As their souls depart this world, they vow to find each other again in the next life. This story is a romance with elements of comedy and suspense.